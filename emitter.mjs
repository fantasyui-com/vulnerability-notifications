/*
 classification: PROGRAM
           name: Vulnerability Notifications
    description: Attempt to update npm packages marked by github as vulnerable
         author: Fantasy UI - https://github.com/fantasyui-com
*/

// Load Modules
import EventEmitter from 'events';

import helloWorld from './code_modules/hello-world';
import fixVulnerabilities from './code_modules/fix-vulnerabilities';

class MyEmitter extends EventEmitter {}
const myEmitter = new MyEmitter();

export default async function main(context={}){


    // Hello World: Print &quot;Hello World&quot; and exit
    myEmitter.on('hello-world', (input, next) => {
      console.log('hello-world event occurred!');
      const helloWorldData = await helloWorld({context, input:input});
      if(next) next(null, helloWorldData)
    });


    // Fix Vulnerabilities: Attempt to fix npm-packages.
    myEmitter.on('fix-vulnerabilities', (input, next) => {
      console.log('fix-vulnerabilities event occurred!');
      const fixVulnerabilitiesData = await fixVulnerabilities({context, input:input});
      if(next) next(null, fixVulnerabilitiesData)
    });


  return myEmitter;
}
